<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MoMoney.Views.AddTransactionPage"
             x:DataType="viewmodel:AddTransactionViewModel"
             xmlns:models="clr-namespace:MoMoney.Models"
             xmlns:viewmodel="clr-namespace:MoMoney.ViewModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:input="clr-namespace:Syncfusion.Maui.Inputs;assembly=Syncfusion.Maui.Inputs">

    <!-- main page -->
    <ScrollView>
        <Grid>
            <VerticalStackLayout>

                <!-- title -->
                <Grid BackgroundColor="{StaticResource Green}" HeightRequest="55" Padding="10,0">
                    <Label Style="{StaticResource lblTitle}" Text="Add Transaction" VerticalOptions="Center" />
                </Grid>

                <!-- transaction type buttons -->
                <Frame HeightRequest="46" Margin="10" Padding="0" BackgroundColor="{StaticResource Gray700}">
                    <Grid x:Name="grdTransactionTypeButtons" ColumnDefinitions="*,*,*">
                        <Button x:Name="btnIncome" Grid.Column="0" Text="Income" HeightRequest="45" Clicked="btnIncome_Clicked" />
                        <Button x:Name="btnExpense" Grid.Column="1" Text="Expense" HeightRequest="45" Clicked="btnExpense_Clicked" />
                        <Button x:Name="btnTransfer" Grid.Column="2" Text="Transfer" HeightRequest="45" Clicked="btnTransfer_Clicked" />
                    </Grid>
                </Frame>
                
                <!-- Date -->
                <Frame Style="{StaticResource frTile}">
                    <Grid ColumnDefinitions="0.15*,*">
                        <Image Source="calendar.svg" Style="{StaticResource icon}" />
                        <DatePicker x:Name="dtDate" 
                                    Grid.Column="1"
                                    VerticalOptions="Center" 
                                    Date="{Binding Date}" />
                    </Grid>
                </Frame>
                
                <!-- Account -->
                <Frame Style="{StaticResource frTile}">
                    <Grid ColumnDefinitions="0.15*,*">
                        <Image Source="credit_card.svg" Style="{StaticResource icon}" />
                        <Picker x:Name="pckAccount"
                                Grid.Column="1"
                                Title="Select an Account"
                                x:DataType="models:Account"
                                ItemDisplayBinding="{Binding AccountName}"
                                SelectedItem="{Binding Path=Account, Source={RelativeSource AncestorType={x:Type viewmodel:AddTransactionViewModel}}}"
                                ItemsSource="{Binding Path=Accounts, Source={RelativeSource AncestorType={x:Type viewmodel:AddTransactionViewModel}}}" />
                    </Grid>
                </Frame>
                
                <!-- Amount -->
                <Frame Style="{StaticResource frTile}">
                    <Grid ColumnDefinitions="0.15*,*">
                        <Image Source="dollar_symbol.svg" Style="{StaticResource icon}" />
                        <Entry x:Name="txtAmount"
                               Grid.Column="1"
                               Keyboard="Numeric"
                               Placeholder="$0.00"
                               Text="{Binding Amount}" />
                    </Grid>
                </Frame>
                
                <!-- Category -->
                <Frame Style="{StaticResource frTile}">
                    <Grid ColumnDefinitions="0.15*,*">
                        <Image Source="category.svg" Style="{StaticResource icon}" />
                        <Picker x:Name="pckCategory"
                                Grid.Column="1"
                                Title="Select a Category"
                                x:DataType="models:Category"
                                ItemDisplayBinding="{Binding CategoryName}"
                                SelectedItem="{Binding Path=Category, Source={RelativeSource AncestorType={x:Type viewmodel:AddTransactionViewModel}}}"
                                ItemsSource="{Binding Path=Categories, Source={RelativeSource AncestorType={x:Type viewmodel:AddTransactionViewModel}}}"
                                SelectedIndexChanged="pckCategory_SelectedIndexChanged" />
                    </Grid>
                </Frame>
                
                <!-- Subcategory -->
                <Frame Style="{StaticResource frTile}">
                    <Grid ColumnDefinitions="0.15*,*">
                        <Image Source="subcategory.svg" Style="{StaticResource icon}" />
                        <Picker x:Name="pckSubcategory"
                                Grid.Column="1"
                                Title="Select a Subcategory"
                                x:DataType="models:Category"
                                ItemDisplayBinding="{Binding CategoryName}"
                                SelectedItem="{Binding Path=Subcategory, Source={RelativeSource AncestorType={x:Type viewmodel:AddTransactionViewModel}}}"
                                ItemsSource="{Binding Path=Subcategories, Source={RelativeSource AncestorType={x:Type viewmodel:AddTransactionViewModel}}}" />
                    </Grid>
                </Frame>
                
                <!-- Payee -->
                <Frame x:Name="frPayee" Style="{StaticResource frTile}" IsVisible="True">
                    <Grid ColumnDefinitions="0.15*,*">
                        <Image Source="account.svg" Style="{StaticResource icon}" />
                        <input:SfAutocomplete x:Name="entPayee"
                                              Grid.Column="1"
                                              TextColor="#888"
                                              BackgroundColor="Transparent"
                                              Stroke="{StaticResource Gray400}"
                                              ClearButtonIconColor="{StaticResource Gray400}"
                                              IsClearButtonVisible="True"
                                              MaxDropDownHeight = "200"
                                              Placeholder="Payee"
                                              TextSearchMode="Contains"
                                              ItemsSource="{Binding Payees}" />
                    </Grid>
                </Frame>
                
                <!-- Transfer Payee Account -->
                <Frame x:Name="frTransferTo" Style="{StaticResource frTile}" IsVisible="False">
                    <Grid ColumnDefinitions="0.15*,*">
                        <Image Source="account.svg" Style="{StaticResource icon}" />
                        <Picker x:Name="pckTransferTo"
                                Grid.Column="1"
                                Title="Select an Account"
                                x:DataType="models:Account"
                                ItemDisplayBinding="{Binding AccountName}"
                                SelectedItem="{Binding Path=TransferAccount, Source={RelativeSource AncestorType={x:Type viewmodel:AddTransactionViewModel}}}"
                                ItemsSource="{Binding Path=Accounts, Source={RelativeSource AncestorType={x:Type viewmodel:AddTransactionViewModel}}}" />
                    </Grid>
                </Frame>
                
                <!-- clear/enter buttons -->
                <Grid x:Name="grdAcceptButtons" Margin="10,0,10,10" Padding="2" ColumnDefinitions="*,*" ColumnSpacing="10">
                    <Button x:Name="btnClear"
                            Grid.Column="0"
                            Text="Clear"
                            HeightRequest="45"
                            BackgroundColor="{StaticResource Blue}"
                            Clicked="btnClear_Clicked" />
                    <Button x:Name="btnEnter"
                            Grid.Column="1"
                            Text="Accept"
                            HeightRequest="45"
                            BackgroundColor="{StaticResource Green}"
                            Clicked="btnEnter_Clicked"
                            Command="{Binding AddCommand}"
                            CommandParameter="{Binding Source={x:Reference entPayee}, Path=Text}"/>
                </Grid>

            </VerticalStackLayout>
        </Grid>
    </ScrollView>

</ContentView>